/*! Copyright 2025 Adobe
All Rights Reserved. */
import{jsx as t,jsxs as f,Fragment as I}from"@dropins/tools/preact-jsx-runtime.js";import{classes as xe}from"@dropins/tools/lib.js";import{Modal as Ze,Price as se,ContentGrid as De,ImageSwatch as Xe,Button as le,Skeleton as Je,SkeletonRow as Qe,Field as j,Checkbox as ne,Input as _e,TextArea as Ye,Accordion as Me,AccordionSection as We,Icon as D,Card as Pe,ProgressSpinner as Ue}from"@dropins/tools/components.js";/* empty css                   */import*as X from"@dropins/tools/preact-compat.js";import{useRef as et,useEffect as J,useState as M,useId as Ne,useCallback as K,useMemo as oe}from"@dropins/tools/preact-hooks.js";import{useText as Z}from"@dropins/tools/i18n.js";import{s as A}from"../chunks/resetCart.js";import{S as Ve}from"../chunks/ChevronUp.js";import{S as $e}from"../chunks/ChevronDown.js";import{events as tt}from"@dropins/tools/event-bus.js";import{u as rt}from"../chunks/updateProductsFromCart.js";import{s as it}from"../chunks/setGiftOptionsOnCart.js";import"@dropins/tools/fetch-graphql.js";import"../chunks/persisted-data.js";import"../chunks/refreshCart.js";import"../fragments.js";import"../chunks/acdl.js";const U=e=>X.createElement("svg",{width:24,height:24,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},X.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M0.75 12C0.75 5.78421 5.78421 0.75 12 0.75C18.2158 0.75 23.25 5.78421 23.25 12C23.25 18.2158 18.2158 23.25 12 23.25C5.78421 23.25 0.75 18.2158 0.75 12Z",stroke:"currentColor"}),X.createElement("path",{vectorEffect:"non-scaling-stroke",d:"M6.75 12.762L10.2385 15.75L17.25 9",stroke:"currentColor"})),ae=e=>X.createElement("svg",{width:20,height:23,viewBox:"0 0 20 23",fill:"none",xmlns:"http://www.w3.org/2000/svg",...e},X.createElement("path",{d:"M10 6L10 21.5M10 6H12.25C13.4926 6 14.5 4.99264 14.5 3.75C14.5 2.50736 13.4926 1.5 12.25 1.5C11.0074 1.5 10 2.50736 10 3.75M10 6V3.75M10 6H7.75C6.50736 6 5.5 4.99264 5.5 3.75C5.5 2.50736 6.50736 1.5 7.75 1.5C8.99264 1.5 10 2.50736 10 3.75M3.25 10.75H16.75C17.9926 10.75 19 9.74264 19 8.5C19 7.25736 17.9926 6.25 16.75 6.25H3.25C2.00736 6.25 1 7.25736 1 8.5C1 9.74264 2.00736 10.75 3.25 10.75ZM4.75 21.5H15.25C16.4926 21.5 17.5 20.4926 17.5 19.25V13.25C17.5 12.0074 16.4926 11 15.25 11H4.75C3.50736 11 2.5 12.0074 2.5 13.25V19.25C2.5 20.4926 3.50736 21.5 4.75 21.5Z",stroke:"currentColor",strokeWidth:1.5}));function nt(e){const i=et(null);return J(()=>{if(!e||!i.current)return;const s=i.current,d=s.querySelectorAll('a, button, input, textarea, select, details, [tabindex]:not([tabindex="-1"])');if(d.length===0)return;const r=d[0],c=d[d.length-1];function g(o){o.key==="Tab"&&(o.shiftKey&&document.activeElement===r?(o.preventDefault(),c.focus()):!o.shiftKey&&document.activeElement===c&&(o.preventDefault(),r.focus()))}return s.addEventListener("keydown",g),()=>{s.removeEventListener("keydown",g)}},[e]),i}const ot=({view:e,showModal:i,productName:s,giftWrappingConfig:d,setShowModal:r,updateGiftOptions:c})=>{var l;const g=nt(i),o=Z({modalTitle:"Cart.GiftOptions.modal.title",defaultTitle:"Cart.GiftOptions.modal.defaultTitle",modalWrappingText:"Cart.GiftOptions.modal.wrappingText",modalWrappingSubText:"Cart.GiftOptions.modal.wrappingSubText",modalConfirmButton:"Cart.GiftOptions.modal.modalConfirmButton",modalCancelButton:"Cart.GiftOptions.modal.modalCancelButton",ariaLabelModal:"Cart.GiftOptions.modal.ariaLabelModal",ariaLabelModalOpen:"Cart.GiftOptions.modal.ariaLabelModalOpen",ariaLabelModalClose:"Cart.GiftOptions.modal.ariaLabelModalClose",ariaLabelWrapping:"Cart.GiftOptions.modal.ariaLabelWrapping"}),[n,O]=M();if(J(()=>{const p=d.find(v=>v.selected)??d[0];O(p)},[d]),J(()=>{const p=document==null?void 0:document.querySelector(".cart-gift-options-view__modal-wrapper");p&&(p==null||p.focus())},[]),!i||!d.length)return null;const C=s?`${o.modalTitle} ${s}`:o.defaultTitle;return t("div",{ref:g,className:"cart-gift-options-view__modal-wrapper",tabIndex:0,"aria-label":`${o.ariaLabelModal} ${i?o.ariaLabelModalOpen:o.ariaLabelModalClose} ${s}`,children:f(Ze,{"data-testid":`gift-option-modal-${e}`,className:"cart-gift-options-view__modal",size:"medium",title:f(I,{children:[t("span",{children:C}),n&&((l=n==null?void 0:n.price)==null?void 0:l.value)>0?t(se,{amount:n.price.value,currency:n.price.currency,weight:"normal"}):null]}),centered:!0,onClose:r,children:[f("div",{className:"cart-gift-options-view__modal-content",children:[t("span",{className:"cart-gift-options-view__modal-text",children:o.modalWrappingText}),t(De,{emptyGridContent:t(I,{}),maxColumns:6,columnWidth:"100px",className:"cart-gift-options-view__modal-grid",children:d.map(p=>t(Xe,{groupAriaLabel:o.ariaLabelWrapping,selected:(n==null?void 0:n.uid)===(p==null?void 0:p.uid),onValue:()=>{O(p)},name:"giftWrappingId",value:p.uid,src:p.image.url,alt:p.design,label:p.design,"data-testid":`gift-option-modal-image-${p.uid}`,className:"cart-gift-options-view__modal-grid-item"},p.uid))}),t("span",{className:"cart-gift-options-view__modal-sub-text",children:n==null?void 0:n.design})]}),t(le,{"data-testid":"gift-option-modal-confirm-button",type:"button",onClick:()=>{c("giftWrappingId",n==null?void 0:n.uid,{isGiftWrappingSelected:!0}),r()},children:o.modalConfirmButton}),t(le,{type:"button",variant:"secondary",onClick:r,"data-testid":"gift-option-modal-cancel-button",children:o.modalCancelButton})]})})},lt=()=>t(Je,{children:t(Qe,{variant:"row",size:"small",fullWidth:!0,lines:1,multilineGap:"small"})}),at=({className:e,view:i,item:s,giftOptions:d,disabled:r,cartData:c,giftWrappingConfig:g,setShowModal:o,onInputChange:n,areGiftOptionsVisible:O})=>{var N,R,B,z;const C=Ne(),l=Z({customize:`Cart.GiftOptions.${i}.customize`,giftReceiptIncludedTitle:`Cart.GiftOptions.${i}.giftReceiptIncluded.title`,giftReceiptIncludedText:`Cart.GiftOptions.${i}.giftReceiptIncluded.subtitle`,printedCardIncludedTitle:`Cart.GiftOptions.${i}.printedCardIncluded.title`,printedCardIncludedText:`Cart.GiftOptions.${i}.printedCardIncluded.subtitle`,giftOptionsWrapTitle:`Cart.GiftOptions.${i}.giftOptionsWrap.title`,giftOptionsWrapText:`Cart.GiftOptions.${i}.giftOptionsWrap.subtitle`,requiredFieldError:"Cart.GiftOptions.formText.requiredFieldError"}),p=s==null?void 0:s.productGiftWrapping,v=c==null?void 0:c.cartGiftWrapping,w=i==="product"?p:v,G=w==null?void 0:w.find(k=>k.uid===d.giftWrappingId),W=(G==null?void 0:G.design)??"",m=s==null?void 0:s.giftWrappingPrice,T=W?`${l.giftOptionsWrapText} ${W}`:"",_=+(((R=(N=A.config)==null?void 0:N.printedCardPrice)==null?void 0:R.value)??0)>0?(B=A.config)==null?void 0:B.printedCardPrice:null;let F=null;m!=null&&m.value?F=m:(z=G==null?void 0:G.price)!=null&&z.value&&(F=G.price);const P=k=>k?f("span",{children:["Â (+",t(se,{amount:k.value,currency:k.currency,weight:"normal"}),")"]}):null;return f("div",{className:xe([e,[`${e}--hidden`,!O.isGiftOptionsVisible]]),children:[O.isGiftReceiptVisible?t(j,{disabled:r,className:"cart-gift-options-view__field-gift-receipt",children:t(ne,{id:`giftReceiptIncluded-${C}`,disabled:r,name:"giftReceiptIncluded",checked:d.giftReceiptIncluded,placeholder:l.giftReceiptIncludedTitle,label:l.giftReceiptIncludedTitle,description:l.giftReceiptIncludedText,onChange:n})}):null,O.isPrintedCartVisible?t(j,{disabled:r,className:"cart-gift-options-view__field-printed-card",children:t(ne,{id:`printedCardIncluded-${C}`,disabled:r,name:"printedCardIncluded",checked:d.printedCardIncluded,placeholder:l.printedCardIncludedTitle,label:f(I,{children:[l.printedCardIncludedTitle,P(_)]}),description:l.printedCardIncludedText,onChange:n})}):null,O.isGiftWrappingVisible?f(I,{children:[t(j,{disabled:r,className:"cart-gift-options-view__field-gift-wrap",children:t(ne,{id:`giftOptionsWrap-${C}`,disabled:r,name:"isGiftWrappingSelected",checked:d.isGiftWrappingSelected,placeholder:l.giftOptionsWrapTitle,label:f(I,{children:[l.giftOptionsWrapTitle,P(F)]}),description:T,onChange:n})}),t(le,{disabled:r||!g.length,type:"button","data-testid":`gift-option-customize-${i}`,variant:"tertiary",onClick:()=>o(!0),children:l.customize})]}):null]})},st=({view:e,giftOptions:i,disabled:s,errorMessage:d,onInputChange:r,onBlur:c,isGiftMessageVisible:g})=>{const o=Ne(),n=Z({formTitle:`Cart.GiftOptions.${e}.formContent.formTitle`,formTo:`Cart.GiftOptions.${e}.formContent.formTo`,formFrom:`Cart.GiftOptions.${e}.formContent.formFrom`,giftMessageTitle:`Cart.GiftOptions.${e}.formContent.giftMessageTitle`,formToPlaceholder:`Cart.GiftOptions.${e}.formContent.formToPlaceholder`,formFromPlaceholder:`Cart.GiftOptions.${e}.formContent.formFromPlaceholder`,formMessagePlaceholder:`Cart.GiftOptions.${e}.formContent.formMessagePlaceholder`});return g?f(I,{children:[t("span",{children:n.formTitle}),f("div",{children:[t("span",{children:n.formTo}),t(j,{disabled:s,error:d.recipientName,children:t(_e,{id:`recipientName-${o}`,disabled:s,type:"text",name:"recipientName",value:i.recipientName,placeholder:n.formToPlaceholder,onChange:r,onBlur:c})})]}),f("div",{children:[t("span",{children:n.formFrom}),t(j,{disabled:s,error:d.senderName,children:t(_e,{id:`senderName-${o}`,disabled:s,type:"text",name:"senderName",value:i.senderName,placeholder:n.formFromPlaceholder,onChange:r,onBlur:c})})]}),f("div",{children:[t("span",{children:n.giftMessageTitle}),t(j,{disabled:s,children:t(Ye,{id:`message-${o}`,errorMessage:d.message,disabled:s,name:"message",value:i.message,label:n.formMessagePlaceholder,onChange:r,onBlur:c})})]})]}):null},dt=({view:e,giftOptions:i,giftWrappingConfig:s,readOnlyFormOrderView:d})=>{const r=Z({readOnlyProductTitle:"Cart.GiftOptions.product.readOnlyFormView.title",wrapping:"Cart.GiftOptions.product.readOnlyFormView.wrapping",recipient:"Cart.GiftOptions.product.readOnlyFormView.recipient",sender:"Cart.GiftOptions.product.readOnlyFormView.sender",message:"Cart.GiftOptions.product.readOnlyFormView.message",readOnlyOrderTitle:"Cart.GiftOptions.order.readOnlyFormView.title",readOnlyOrderGiftReceiptTitle:"Cart.GiftOptions.order.readOnlyFormView.giftReceipt",readOnlyOrderGiftReceiptText:"Cart.GiftOptions.order.readOnlyFormView.giftReceiptText",readOnlyOrderGiftPrintCardTitle:"Cart.GiftOptions.order.readOnlyFormView.printCard",readOnlyOrderGiftPrintCardText:"Cart.GiftOptions.order.readOnlyFormView.printCardText",readOnlyOrderGiftWrapTitle:"Cart.GiftOptions.order.readOnlyFormView.giftWrap",readOnlyOrderGiftWrapOptionsText:"Cart.GiftOptions.order.readOnlyFormView.giftWrapOptions",readOnlyOrderFormTitle:"Cart.GiftOptions.order.readOnlyFormView.formTitle",readOnlyOrderFormTo:"Cart.GiftOptions.order.readOnlyFormView.formTo",readOnlyOrderFormFrom:"Cart.GiftOptions.order.readOnlyFormView.formFrom",readOnlyOrderFormMessageTitle:"Cart.GiftOptions.order.readOnlyFormView.formMessageTitle"}),{recipientName:c,senderName:g,message:o,giftReceiptIncluded:n,printedCardIncluded:O,isGiftWrappingSelected:C}=i,l=s==null?void 0:s.find(({uid:m})=>m===(i==null?void 0:i.giftWrappingId)),p=!!c||!!g||!!o,v=l==null?void 0:l.design,w=n||O||(l==null?void 0:l.selected),G=[{id:1,title:r.wrapping,message:C?v:""},{id:2,title:r.recipient,message:c},{id:3,title:r.sender,message:g},{id:4,title:r.message,message:o}],W=G.every(({message:m})=>!m);if(e==="product"&&!W)return t(Me,{"data-testid":"gift-options-product",iconClose:Ve,iconOpen:$e,actionIconPosition:"right",children:t(We,{title:r.readOnlyProductTitle,showIconLeft:!0,iconLeft:ae,defaultOpen:!1,renderContentWhenClosed:!1,children:t("div",{children:G.filter(m=>m.message).map(m=>f("p",{children:[m.title," ",m.message]},m.id))})})});if(e==="order"&&(p||w)){const m=f("div",{className:"cart-gift-options-readonly__header",children:[t(D,{source:ae,size:"24"}),t("span",{children:r.readOnlyOrderTitle})]}),T=f(I,{children:[n?f("div",{className:"cart-gift-options-readonly__checkboxes cart-gift-options-readonly__checkboxes--gift-receipt",children:[t(D,{source:U,size:"16"}),t("p",{children:r.readOnlyOrderGiftReceiptTitle}),t("p",{children:r.readOnlyOrderGiftReceiptText})]}):null,O?f("div",{className:"cart-gift-options-readonly__checkboxes cart-gift-options-readonly__checkboxes--print-card",children:[t(D,{source:U,size:"16"}),t("p",{children:r.readOnlyOrderGiftPrintCardTitle}),t("p",{children:r.readOnlyOrderGiftPrintCardText})]}):null,l!=null&&l.selected?f("div",{className:"cart-gift-options-readonly__checkboxes cart-gift-options-readonly__checkboxes--gift-wrap",children:[t(D,{source:U,size:"16"}),f("p",{children:[r.readOnlyOrderGiftWrapTitle," (+",t(se,{amount:l.price.value,currency:l.price.currency,weight:"normal"}),")"]}),t("p",{children:`${r.readOnlyOrderGiftWrapOptionsText} ${l==null?void 0:l.design}`})]}):null]}),_=p?f("div",{className:"cart-gift-options-readonly__form",children:[t("div",{children:r.readOnlyOrderFormTitle}),f("div",{children:[f("p",{children:[t("span",{children:r.readOnlyOrderFormTo}),t("span",{children:c})]}),f("p",{children:[t("span",{children:r.readOnlyOrderFormFrom}),t("span",{children:g})]})]}),f("div",{children:[t("p",{children:r.readOnlyOrderFormMessageTitle}),t("p",{children:o})]})]}):null;return f(Pe,{variant:d,children:[m,T,_]})}return null},ct=({item:e,view:i,loading:s,giftOptions:d,showModal:r,isEditable:c,errorsField:g,updateLoading:o,cartData:n,fieldsDisabled:O,isGiftOptionsApplied:C,giftWrappingConfig:l,readOnlyFormOrderView:p,isGiftMessageVisible:v,areGiftOptionsVisible:w,onBlur:G,setShowModal:W,updateGiftOptions:m,onInputChange:T,handleFormMouseLeave:_})=>{const F=Z({accordionHeading:`Cart.GiftOptions.${i}.accordionHeading`}),P=K(N=>t(Me,{"data-testid":"gift-options-product",iconClose:Ve,iconOpen:$e,actionIconPosition:"right",children:t(We,{title:f("div",{className:"cart-gift-options-view__icon--success",children:[t("span",{children:F.accordionHeading}),C?t(D,{source:U,size:"16"}):null]}),ariaLabelTitle:F.accordionHeading,showIconLeft:!0,iconLeft:ae,defaultOpen:C||N,renderContentWhenClosed:!1,children:f(I,{children:[t(at,{className:"cart-gift-options-view__top",view:i,item:e,giftOptions:d,disabled:O,onInputChange:T,cartData:n,giftWrappingConfig:l,setShowModal:W,areGiftOptionsVisible:w}),t("form",{className:"cart-gift-options-view__footer",onMouseLeave:_,children:t(st,{view:i,giftOptions:d,disabled:O,errorMessage:g,onInputChange:T,onBlur:G,isGiftMessageVisible:v})})]})})}),[i,e,n,F,g,d,O,l,w,C,v,G,W,T,_]);return!w.isGiftOptionsVisible&&!v?null:f("div",{id:"cart-gift-options-view",className:xe(["cart-gift-options-view",`cart-gift-options-view--${i}`,["cart-gift-options-view--loading",o]]),children:[o?t(Ue,{className:"cart-gift-options-view__spinner"}):null,s?t(lt,{}):f(I,{children:[c?null:t("div",{className:"cart-gift-options-view--readonly",children:t(dt,{view:i,giftOptions:d,giftWrappingConfig:l,readOnlyFormOrderView:p})}),r?t(ot,{view:i,productName:e&&"name"in e?e==null?void 0:e.name:"",showModal:r,giftWrappingConfig:l,setShowModal:()=>W(!1),updateGiftOptions:m}):null,i==="product"&&c?P(!1):null,i==="order"&&c?t(Pe,{variant:"secondary",children:P(!0)}):null]})]})},Y={recipientName:"",senderName:"",message:""},ft={giftReceiptIncluded:!1,printedCardIncluded:!1,isGiftWrappingSelected:!1},Re=(e,i)=>{var d,r;if(!i)return!!((d=A.config)!=null&&d.allowGiftMessageOnOrder);const s=((r=A.config)==null?void 0:r.allowGiftMessageOnOrderItems)??!1;return typeof(e==null?void 0:e.giftMessageAvailable)=="boolean"?e==null?void 0:e.giftMessageAvailable:s},pt=(e,i)=>{const{allowGiftWrappingOnOrder:s,allowGiftWrappingOnOrderItems:d,allowGiftMessageOnOrder:r,allowGiftMessageOnOrderItems:c,allowGiftReceipt:g,allowPrintedCard:o}=A.config||{},n=!c&&!d&&!Re(i,!0),O=!s&&!r&&!g&&!o;return!!(e==="product"&&n||e==="order"&&O)},ut=({item:e,view:i,dataSource:s,initialLoading:d,handleItemsLoading:r,handleItemsError:c,onItemUpdate:g,onGiftOptionsChange:o})=>{var ce,fe,pe,ue,ge,me;const n=i==="product",O=Z({requiredFieldError:"Cart.GiftOptions.formText.requiredFieldError"}),[C,l]=M(()=>d),[p,v]=M({isGiftReceiptVisible:!0,isPrintedCartVisible:!0,isGiftWrappingVisible:!0,isGiftOptionsVisible:!0}),[w,G]=M(!0),[W,m]=M(!1),[T,_]=M(!1),[F,P]=M(!1),[N,R]=M(!1),[B,z]=M(!1),[k,ke]=M([]),[h,Se]=M(null),[Le,ee]=M(Y),[y,de]=M(()=>({giftWrappingId:"",...Y,...ft})),te=((ce=y.recipientName)==null?void 0:ce.trim())&&((fe=y.senderName)==null?void 0:fe.trim())&&((pe=y.message)==null?void 0:pe.trim()),Q=!((ue=y.recipientName)!=null&&ue.trim())&&!((ge=y.senderName)!=null&&ge.trim())&&!((me=y.message)!=null&&me.trim()),$=K(async a=>{switch(m(i==="order"),_(!0),i){case"product":{"uid"in e&&(r==null||r(e.uid,!0),c==null||c(e.uid));const{recipientName:u,senderName:x,message:b,giftWrappingId:E,isGiftWrappingSelected:S}=a,H={gift_message:{to:u??"",from:x??"",message:b??""},gift_wrapping_id:S?E:null};"uid"in e&&"quantity"in e&&await rt([{uid:e.uid,quantity:e.quantity,giftOptions:H}]).then(()=>{g==null||g({item:e})}).finally(()=>{r==null||r(e.uid,!1),_(!1),P(!1),m(!1)}).catch(V=>{console.warn(V)})}break;case"order":await it(a).finally(()=>{_(!1),P(!1),m(!1)});break;default:console.error('Incorrect "view" prop value provided for GiftOptions container (storefront-cart)');break}},[c,r,e,g,i]),re=K((a,u,x={})=>{de(b=>{const E=L=>L in b,S=L=>E(L)?b[L]:void 0;if(!(S(a)!==u||Object.keys(x).some(L=>S(L)!==x[L])))return o==null||o(b),b;const V={...b,[a]:u,...x};return!V.recipientName&&!V.senderName&&!V.message&&R(!0),(typeof u=="boolean"||["giftWrappingId","giftReceiptIncluded","printedCardIncluded"].includes(a))&&(typeof o=="function"?o(V):$(V)),P(!0),o==null||o(V),V})},[$,o]),Ae=K(async()=>{T||typeof o!="function"&&(Q&&N&&(ee(Y),R(!1),await $(y)),F&&te&&(R(!0),await $(y)))},[$,y,F,Q,N,T,o]),Ie=K(async a=>{if(T||typeof o=="function")return;const{name:u,value:x}=a.target;ee(b=>({...b,[u]:x.trim()?"":O.requiredFieldError})),Q&&N&&(ee(Y),R(!1),await $(y)),F&&te&&await $(y)},[T,Q,N,F,te,O,$,y,o]),Ee=K(a=>{const u=a.target,x=u.name,b=u.type==="checkbox"?u.checked:u.value;re(x,b)},[re]);J(()=>{if(n)return;const a=tt.on(s==="cart"?"cart/data":"order/data",u=>{var E,S;Se(u);const x=(E=u==null?void 0:u.items)==null?void 0:E.every(({giftWrappingAvailable:H})=>H),b=(S=u==null?void 0:u.cartGiftWrapping)==null?void 0:S.some(H=>H.selected);!x&&b&&$({...y,giftWrappingId:"",isGiftWrappingSelected:!1})},{eager:!0});return()=>{a==null||a.off()}},[$,s,y,n]);const ie=oe(()=>{var Ge,ye,Te,be,Fe,ve;if(!h&&!e)return null;const a=n?(Ge=e==null?void 0:e.productGiftWrapping)==null?void 0:Ge.map(q=>{var we;return{...q,price:e!=null&&e.giftWrappingPrice&&((we=e==null?void 0:e.giftWrappingPrice)==null?void 0:we.value)>0?e.giftWrappingPrice:q.price}}):(h==null?void 0:h.cartGiftWrapping)||[],u=a==null?void 0:a.find(q=>q.selected),x=(u==null?void 0:u.uid)??((ye=a==null?void 0:a[0])==null?void 0:ye.uid),b=!!u,E=n?e.giftMessage:h==null?void 0:h.giftMessage,S=h==null?void 0:h.printedCardIncluded,H=h==null?void 0:h.giftReceiptIncluded,V=Re(e,n),L=(Te=A.config)==null?void 0:Te.allowGiftWrappingOnOrder,ze=(be=A.config)==null?void 0:be.allowGiftReceipt,qe=(Fe=A.config)==null?void 0:Fe.allowPrintedCard,Ke=(ve=h==null?void 0:h.items)==null?void 0:ve.every(q=>q.giftWrappingAvailable),je=e==null?void 0:e.giftWrappingAvailable,Oe=n?!1:!!ze,he=n?!1:!!qe,Ce=n?!!je&&!!a.length:!!L&&!!a.length&&!!Ke;return v({isGiftReceiptVisible:Oe,isPrintedCartVisible:he,isGiftWrappingVisible:Ce,isGiftOptionsVisible:!(!Oe&&!he&&!Ce)}),G(V),{...e&&"uid"in e?{itemId:e.uid}:{},...n?{}:{printedCardIncluded:S,giftReceiptIncluded:H},...E,giftWrappingId:x,isGiftWrappingSelected:b,giftWrappingOptions:a}},[h,e,n]);J(()=>{if(!ie)return;const{giftWrappingOptions:a,...u}=ie;de(u),a!=null&&a.length&&ke(a),l(!1)},[ie]);const He=oe(()=>Object.entries(y).filter(([a])=>a!=="itemId"&&a!=="giftWrappingId").some(([,a])=>!!a),[y]),Be=oe(()=>{var a;return!C&&!!((a=A)!=null&&a.config)&&pt(i,e)},[e,C,i]);return{loading:C,giftOptions:y,showModal:B,errorsField:Le,updateLoading:W,cartData:h,fieldsDisabled:T,isGiftOptionsApplied:He,giftWrappingConfig:k,setFieldsDisabled:_,handleFormMouseLeave:Ae,onInputChange:Ee,updateGiftOptions:re,setShowModal:z,handleBlur:Ie,isGiftMessageVisible:w,areGiftOptionsVisible:p,isGiftOptionsHidden:Be}},Vt=({item:e,view:i="order",readOnlyFormOrderView:s="primary",dataSource:d="cart",isEditable:r=!0,initialLoading:c=!0,handleItemsLoading:g,handleItemsError:o,onItemUpdate:n,onGiftOptionsChange:O})=>{const{isGiftMessageVisible:C,areGiftOptionsVisible:l,loading:p,giftOptions:v,showModal:w,errorsField:G,updateLoading:W,cartData:m,isGiftOptionsApplied:T,fieldsDisabled:_,giftWrappingConfig:F,handleFormMouseLeave:P,updateGiftOptions:N,setShowModal:R,onInputChange:B,handleBlur:z,isGiftOptionsHidden:k}=ut({item:e,view:i,dataSource:d,initialLoading:c,handleItemsLoading:g,handleItemsError:o,onItemUpdate:n,onGiftOptionsChange:O});return k?null:t(ct,{item:e,view:i,loading:p,onBlur:z,giftOptions:v,showModal:w,isEditable:r,errorsField:G,setShowModal:R,updateLoading:W,updateGiftOptions:N,cartData:m,isGiftOptionsApplied:T,fieldsDisabled:_,giftWrappingConfig:F,handleFormMouseLeave:P,readOnlyFormOrderView:s,onInputChange:B,isGiftMessageVisible:C,areGiftOptionsVisible:l})};export{Vt as GiftOptions,Vt as default};
